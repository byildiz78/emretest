

SELECT posProductUnits.UnitName AS BİRİM,
       posProducts.ProductName AS [ÜRÜN ADI],
       posDailyClosingDetail.OpeningAmount AS AÇILIŞ,
       posDailyClosingDetail.ClosingAmount AS KAPANIŞ,
       posDailyClosingDetail.IncomingAmount AS GİREN,
       posDailyClosingDetail.OutgoingAmount AS ÇIKAN,
       posDailyClosingDetail.TeoricAmount AS [OLMASI GEREKEN],
       posDailyClosingDetail.CountAmount AS SAYIM,
       posDailyClosingDetail.RealUsageAmount AS [GERÇEK KULLANIM],
       posDailyClosingDetail.TeoricUsageAmount AS [IDEAL KULLANIM],
       posDailyClosingDetail.DifferenceAmount AS FARK,
       posDailyClosingHeader.ClosingID AS [SAYIM NO],
       posDailyClosingHeader.ClosingDate AS [SAYIM TARHI],
       efr_Branchs.BranchName AS [ŞUBE ADI],
            
       posProducts.PurchasePrice1 AS [BİRİM_FİYAT],
       
          posDailyClosingDetail.CountAmount *posProducts.PurchasePrice1 AS [SAYIM TUTAR]
       
FROM   posDailyClosingHeader
       INNER JOIN posDailyClosingDetail
            ON  posDailyClosingHeader.ClosingID = posDailyClosingDetail.ClosingID
       INNER JOIN posProductUnits
            ON  posDailyClosingDetail.UnitID = posProductUnits.UnitID
       INNER JOIN efr_Branchs
            ON  posDailyClosingHeader.BranchID = efr_Branchs.BranchID
       LEFT OUTER JOIN posProducts
            ON  posDailyClosingDetail.ProductID = posProducts.ProductID
WHERE  posDailyClosingHeader.ClosingDate >= @date1
       AND posDailyClosingHeader.ClosingDate <= @date2
       AND posDailyClosingDetail.@BranchID
--and posproducts.CustomField10='AYLIK'
AND posDailyClosingHeader.CountType='HAFTALIK SAYIM'