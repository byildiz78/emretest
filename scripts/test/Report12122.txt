SELECT eb.BranchName AS Åžube,l.PickValue AS Kategori,isnull(lk.PickValue,ot.MenumItemCategoryText) AS [Alt Kategori],isnull(lg.PickValue,ot.MenuItemGroupText) AS [Grubu],SUM(ot.ExtendedPrice) AS Tutar
FROM OrderTransactions ot 
INNER JOIN efr_Branchs eb ON eb.BranchID = ot.BranchID
LEFT OUTER JOIN GlobalMenuItems AS M ON ot.MenuItemKey = m.MenuItemKey AND ot.BranchID = m.BranchID
LEFT OUTER JOIN posProducts p ON p.ProductKey = m.MenuItemGlobalKey 
LEFT OUTER JOIN posPickList AS l ON l.ListID = p.MainCategoryID
LEFT OUTER JOIN posPickList AS lg ON lg.ListID = p.GroupID
LEFT OUTER JOIN posPickList AS lk ON lK.ListID = p.CategoryID
WHERE ot.LineDeleted = 0 AND ot.OrderDateTime >= @date1 AND ot.OrderDateTime <= @date2 AND ot.@BranchID
GROUP BY lk.PickValue,lg.PickValue,l.PickValue,eb.BranchName,ot.MenumItemCategoryText,ot.MenuItemGroupText