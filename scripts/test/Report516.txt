DECLARE @tabakSayisi FLOAT;
SET @tabakSayisi=(SELECT round((isnull((nullif(SUM(t.Quantity),0)),0.0)),0) AS reportValue
FROM OrderTransactions AS t WITH(NOLOCK)
INNER JOIN OrderHeaders AS h WITH (NOLOCK) ON t.OrderKey = h.OrderKey 
INNER JOIN posProducts as m WITH (NOLOCK) on m.ProductKey=t.MenuItemKey 
WHERE t.OrderDateTime between @date1 and @date2
AND t.@BranchID
AND h.linedeleted=0
AND t.LineDeleted=0
and h.OrderType !=5
and m.CustomField12='TABAKLAR'
);

SELECT 
SUM(t.Quantity) AS Adet,
round((isnull((100*SUM(t.Quantity)/nullif(@tabakSayisi,0)),0.0)),2) as Oran
FROM OrderTransactions AS t WITH(NOLOCK)
INNER JOIN OrderHeaders AS h WITH (NOLOCK) ON t.OrderKey = h.OrderKey
INNER JOIN posProducts as m WITH (NOLOCK) on m.ProductKey=t.MenuItemKey 
WHERE h.LineDeleted=0
AND t.OrderDateTime between @date1 and @date2
AND t.@BranchID
AND t.LineDeleted=0
and h.OrderType !=5
and m.CustomField13='ÇORBA'