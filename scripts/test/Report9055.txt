

SELECT posProductUnits.UnitName AS BİRİM,
       posProducts.ProductName AS [ÜRÜN ADI],
       posDailyClosingDetail.OpeningAmount AS AÇILIŞ,
       posDailyClosingDetail.ClosingAmount AS KAPANIŞ,
       posDailyClosingDetail.IncomingAmount AS GİREN,
       posDailyClosingDetail.OutgoingAmount AS ÇIKAN,
       posDailyClosingDetail.TeoricAmount AS [OLMASI GEREKEN],
       posDailyClosingDetail.CountAmount AS SAYIM,
       posDailyClosingDetail.RealUsageAmount AS [GERÇEK KULLANIM],
       posDailyClosingDetail.TeoricUsageAmount AS [IDEAL KULLANIM],
       posDailyClosingDetail.DifferenceAmount AS FARK,
       posDailyClosingHeader.ClosingID AS [SAYIM NO],
       posDailyClosingHeader.OpeningDate AS [AÇILIŞ TARHI],
       efr_Branchs.BranchName AS [ŞUBE ADI],
       posDailyClosingDetail.CountAmount*posDailyClosingDetail.AveragePrice AS TUTAR
       
FROM   posDailyClosingHeader
       INNER JOIN posDailyClosingDetail
            ON  posDailyClosingHeader.ClosingID = posDailyClosingDetail.ClosingID
       INNER JOIN posProductUnits
            ON  posDailyClosingDetail.UnitID = posProductUnits.UnitID
       INNER JOIN efr_Branchs
            ON  posDailyClosingHeader.BranchID = efr_Branchs.BranchID
       LEFT OUTER JOIN posProducts
            ON  posDailyClosingDetail.ProductID = posProducts.ProductID
WHERE  posDailyClosingHeader.ClosingDate >= @ilkTarih
       AND posDailyClosingHeader.ClosingDate <= @SonTarih
       AND posDailyClosingDetail.@BranchID
and posproducts.CustomField10='1-GÜNLÜK SAYIM YAPILAN ÜRÜNLER'