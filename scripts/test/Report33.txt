SELECT CustomerCreditAccounts.FirstName AS Ad,
       CustomerCreditAccounts.LastName AS Soyad,
       SUM(ISNULL(OnAccountCharges.AmountCharged, 0)) AS [Borç Tutarı],
       SUM(ISNULL(OnAccountPayments.AmountPaid, 0)) AS [Ödenen Tutar],
       OnAccountPayments.PaymentDateTime AS [Ödeme Tarihi],
       OnAccountCharges.ChargeDateTime AS [Borçlanma Tarihi],
       OnAccountCharges.OrderID AS [Çek No]
FROM   (
           OnAccountCharges LEFT JOIN
           OnAccountPayments ON OnAccountPayments.OrderChargeID = 
           OnAccountCharges.OrderChargeID
           AND OnAccountPayments.BranchID = OnAccountCharges.BranchID
       )
       LEFT JOIN CustomerCreditAccounts
            ON  CustomerCreditAccounts.CustomerID = OnAccountCharges.CustomerID
            AND CustomerCreditAccounts.BranchID = OnAccountCharges.BranchID
WHERE  OnAccountCharges.@BranchID
GROUP BY
       CustomerCreditAccounts.FirstName,
       CustomerCreditAccounts.LastName,
       OnAccountPayments.PaymentDateTime,
       OnAccountCharges.ChargeDateTime,
       OnAccountCharges.OrderID