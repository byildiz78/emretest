Detail|

SELECT 
distinct (orderpayments.OrderPaymentID),
CustomerFiles.CustomerName,
	CustomerFiles.CustomerKey,
       OrderPayments.PaymentDateTime,
       OrderPayments.AmountPaid,
       OrderPayments.CustomerID,
       CASE CONVERT(NVARCHAR(10), ISNULL(OrderPayments.OrderID, '-1'))
            WHEN '-1' THEN ('TAHSÄ°LAT')
            ELSE CONVERT(NVARCHAR(10), OrderPayments.OrderID)
       END AS OrderID,
       OrderPayments.PaymentMethodName  AS PaymentName,
       OrderPayments.IsAccountPayment
       
FROM   OrderPayments
       RIGHT OUTER JOIN CustomerFiles
            ON  OrderPayments.CustomerKey = CustomerFiles.CustomerKey
       LEFT OUTER JOIN PaymentMethods
            ON  OrderPayments.PaymentMethodID = PaymentMethods.PaymentMethodID
WHERE  (OrderPayments.LineDeleted = 0)
      AND OrderPayments.PaymentDateTime >= @ilkTarih
 AND OrderPayments.PaymentDateTime <= @SonTarih
AND OrderPayments.@BranchID and CustomerFiles.@BranchID 
