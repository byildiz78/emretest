SELECT

 wg.GroupName,

W.ReportName as [Rapor Adı],

sum(r.SearchCount) as [Rapor Giriş Sayısı],

MAX ( r.logdate ) as [Rapora son giriş tarihi]

FROM

ReportSearchLogs AS r

RIGHT JOIN infiniaWebReports AS w ON r.ReportID= w.ReportID 

    INNER JOIN infiniaWebReportGroups AS wg on w.GroupID=wg.AutoID

Where

w.ShowDesktop=1

and r.LogDate between @date1 and @date2

GROUP BY

w.ReportName ,wg.GroupName



UNION ALL

SELECT wg.GroupName,wr.ReportName,0,GETDATE() FROM infiniaWebReports wr

INNER JOIN infiniaWebReportGroups AS wg on wr.GroupID=wg.AutoID

 LEFT JOIN ReportSearchLogs logs on logs.ReportID=wr.ReportID

 WHERE logs.ID IS NULL and wr.ShowDesktop=1