SELECT t.MenuItemText as [Ürün],
       SUM(t.Quantity) AS Adet,
   SUM(t.ExtendedPrice)AS Tutar,
    
      
   
       CASE h.OrderType
            WHEN '1' THEN 'MASA SERVIS'
            WHEN '2' THEN 'İSME ÇEK'
            WHEN '3' THEN 'AL GÖTÜR'
            WHEN '4' THEN 'TEZGAH'
            WHEN '5' THEN 'PAKET SERVIS'
            ELSE 'TANIMSIZ'
       END AS 'Satış Türü'
FROM   OrderTransactions AS t
      LEFT OUTER JOIN
                      
                      OrderHeaders AS h ON t.OrderKey = h.OrderKey
WHERE  t.LineDeleted = 0
AND t.OrderDateTime >= @date1
AND t.OrderDateTime <= @date2 and t.@BranchID And h.Linedeleted=0
     
GROUP BY
       MenuItemText,
       h.OrderType
     

       
       
       