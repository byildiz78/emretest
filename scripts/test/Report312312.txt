Hearder | SELECT
h.OrderStatus,
OrderTransactions.OrderID,
OrderTransactions.MenuItemText,
OrderTransactions.BranchID,
h.GuestNumber,
h.DineInTableName,
OrderTransactions.Quantity,
OrderTransactions.ExtendedPrice,
h.CashGratuity,
(SELECT ISNULL(SUM(AmountPaid),0) FROM OrderPayments p where p.OrderKey=OrderTransactions.OrderKey) AS Odenen,
h.AmountDue,
h.DiscountTotalAmount,
h.OrderDateTime,
CONVERT(VARCHAR, OrderTransactions.AddDateTime,8) as AddHour,
h.EmployeeName,
OrderTransactions.AddUserName   AS AddEmployeeName,
	          (
           CASE h.OrderType
                WHEN 1 THEN 'MASA'
                WHEN 2 THEN 'BAR SATIŞI'
                WHEN 3 THEN 'AL GÖTÜR'
                WHEN 4 THEN 'TEZGAH SATIŞI'
                WHEN 5 THEN 'PAKET SATIŞI'
                ELSE '-'
           END
       )                                AS OrderTypeName,


OrderTransactions.OrderKey
      
FROM   OrderTransactions WITH (NOLOCK)

       LEFT JOIN OrderHeaders h on h.OrderKey=OrderTransactions.OrderKey
	  
WHERE  OrderTransactions.OrderDateTime >= @date1
AND OrderTransactions.OrderDateTime <= @date2
AND OrderTransactions.@BranchID
AND OrderTransactions.linedeleted = 0
AND OrderTransactions.MenuItemtext NOT LIKE 'T-%'
AND h.OrderStatus != 3
Order by OrderTransactions.OrderID

$payment | SELECT 

h.OrderKey,
h.OrderID,
p.PaymentMethodName,
p.AmountPaid

FROM OrderPayments p

LEFT JOIN OrderHeaders h on h.OrderKey=p.OrderKey

WHERE p.@BranchID
AND h.OrderDateTime >= @date1
AND h.OrderDateTime <= @date2
AND h.OrderStatus <> 3