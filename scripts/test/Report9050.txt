SELECT p.ProductName,
       ISNULL(p.TaxPercent1, 8) AS KDV,
       ROUND(pr.FormulaCost, 2) AS FormulaCost2,
       ROUND(pp.OutgoingPrice, 2) AS SaleUnitPrice,
       SUM(pr.Quantity) AS Quantity,
       f.GroupName AS PickValue,
       posBranchs.BranchName,
       f.NetCost AS FormulaCost,pr.SaleDateTime 
FROM   posBranchs
       INNER JOIN posManafactureFormulaAssign AS fa
            ON  posBranchs.BranchID = fa.BranchID
       LEFT OUTER JOIN posManafactureFormula AS f
            ON  fa.FormulaID = f.FormulaID
       RIGHT OUTER JOIN posProducts AS p
       INNER JOIN posProductionList AS pr
            ON  p.ProductID = pr.ProductID
       INNER JOIN posProductPrices AS pp
            ON  p.ProductID = pp.ProductID
            ON  fa.ProductID = p.ProductID

WHERE  (pr.SaleDateTime >= @ilkTarih)
       AND (pr.SaleDateTime <= @SonTarih)
       AND (pr.IsProduced = 1)
       
       GROUP BY
       p.ProductName,
       pr.FormulaCost,
       p.TaxPercent1,
       pp.OutgoingPrice,
       f.GroupName,
       posBranchs.BranchName,
       f.NetCost,pr.SaleDateTime 

       
     