Detail|



SELECT 'Açık Çekler' AS Tipi,SUM(CASE WHEN OrderStatus = 1 THEN AmountDue ELSE 0 END) as Tutar FROM OrderHeaders WITH(NOLOCK)




WHERE 

     LineDeleted = 0
       AND orderdateTime > @ilkTarih
       AND OrderDateTime <= @SonTarih
       AND OrderHeaders.@BranchID
UNION ALL

SELECT 'Kapalı Çekler' AS Tipi,SUM(CASE WHEN OrderStatus = 2 THEN AmountDue ELSE 0 END) as Tutar FROM OrderHeaders WITH(NOLOCK)
WHERE 

     LineDeleted = 0
       AND orderdateTime > @ilkTarih
       AND OrderDateTime <= @SonTarih
       AND OrderHeaders.@BranchID

UNION ALL

SELECT 'Toplam Ciro' as Tipi, SUM(AmountDue) AS Tutar FROM OrderHeaders WITH(NOLOCK) WHERE  LineDeleted=0 AND orderdateTime>@ilkTarih AND OrderDateTime<=@SonTarih AND OrderHeaders.@BranchID



$INDIRIMLER|
SELECT COUNT(orderkey) AS [Toplam Çek Sayısı],
       sum(guestNumber)  AS [Toplam Konuk],
       SUM(DiscountTotalAmount) AS [Toplam Indirimler],
       SUM(AmountDue) / nullif(COUNT(orderkey),0) as [Çek Ortalama],
       SUM(AmountDue) / nullif( sum(guestNumber),0) as [Kişi Başı Ortalama]
       
FROM   OrderHeaders WITH(NOLOCK)

     WHERE  orderheaders.LineDeleted = 0
                 AND orderheaders.OrderDateTime >= @date1
                  AND orderheaders.OrderDateTime <= @date2
                  AND orderheaders.@BranchID



$GRUPSATISDAGILIMI|

SELECT 
      
       SUM(t.ExtendedPrice) AS Tutar,
              t.MenuItemGroupText AS Grup
       

FROM  OrderTransactions  t WITH(NOLOCK)
       
WHERE  t.LineDeleted = 0
      
  AND t.OrderDateTime >= @ilkTarih
   AND t.OrderDateTime <= @SonTarih
   and t.@BranchID
GROUP BY
      
      
       t.ExtendedPrice,
   
       t.MenuItemGroupText
     
       
       ORDER BY  SUM(t.ExtendedPrice) DESC
$ODEMEDAGILIMI|SELECT    SUM( AmountPaid) AS GenelTOPLAM, PaymentMethodName
FROM         OrderPayments WITH(NOLOCK)


WHERE  orderpayments.PaymentDateTime >= @ilkTarih
       AND orderpayments.PaymentDateTime <= @SonTarih
       AND OrderPayments.LineDeleted = 0
	   and OrderPayments.@BranchID
      
GROUP BY PaymentMethodName


$IPTALTOPLAMLARI|SELECT 
       SUM(OrderTransactions.ExtendedPrice)
      
FROM   OrderTransactions WITH(NOLOCK)
       INNER JOIN OrderHeaders
            ON  OrderTransactions.OrderKey = OrderHeaders.OrderKey
WHERE  OrderTransactions.OrderDateTime >= @ilkTarih
    AND OrderTransactions.OrderDateTime <= @SonTarih
    AND
   OrderTransactions.linedeleted = 1 and OrderTransactions.TransactionStatus=3
   and OrderTransactions.@BranchID
    AND OrderTransactions.DeleteReason NOT LIKE '%ayrıldı%'
       AND OrderTransactions.DeleteReason NOT LIKE 'ürün taşındı'