SELECT 'Cari Hesap Tahsilat'as Tipi, sum(OrderPayments.AmountPaid) as Tutar
FROM OrderPayments WHERE 
OrderPayments.PaymentDateTime >=@date1 And 
OrderPayments.PaymentDateTime <=@date2 and 
OrderPayments.lineDeleted=0 and OrderPayments.IsaccountPayment=1 
and OrderPayments.@BranchID
UNION ALL
SELECT 'Cari Hesap Satış'as Tipi, sum(OrderPayments.AmountPaid) as Tutar
FROM OrderPayments WHERE 
OrderPayments.PaymentDateTime >=@date1 And 
OrderPayments.PaymentDateTime <=@date2 and 
OrderPayments.lineDeleted=0 and IsAccountSale=1 
and OrderPayments.@BranchID
UNION ALL
Select 'Çek İndirimleri' as Tipi,
Sum(orderheaders.DiscountOrderAmount) As Tutar
From
orderheaders WHERE orderheaders.OrderDateTime <=@date2 And orderheaders.OrderDateTime >=@date1 
And orderheaders.@BranchID
AND orderheaders.LineDeleted=0 and orderheaders.@BranchID 
UNION ALL
Select 'Nakit İndirimler' as Tipi,
Sum(orderheaders.DiscountCashAmount) As Tutar
From
orderheaders WHERE orderheaders.OrderDateTime <=@date2 And orderheaders.OrderDateTime >=@date1 
And orderheaders.@BranchID
AND orderheaders.LineDeleted=0 and orderheaders.@BranchID
UNION ALL
Select 'Ürünİndirimler' as Tipi,
isnull(Sum(orderTransactions.DiscountLineAmount),0) As Tutar
From
orderTransactions WHERE ordertransactions.TransactionDateTime <=@date2 And ordertransactions.TransactionDateTime >=@date1 
And ordertransactions.@BranchID
AND ordertransactions.LineDeleted=0
UNION ALL
SELECT 'Toplam Kasa' AS Tipi,
SUM(OrderPayments.AmountPaid) AS Tutar
FROM OrderPayments
WHERE OrderPayments.PaymentDateTime >= @date1
AND OrderPayments.PaymentDateTime <= @date2 And OrderPayments.@BranchID
AND OrderPayments.LineDeleted=0 --and IsAccountSale<>1
UNION ALL
SELECT 'Açık Çekler' AS Tipi,
SUM(orderheaders.AmountDue) AS Toplam
FROM orderheaders
WHERE orderheaders.OrderStatus = '1'
AND orderheaders.OrderDateTime >= @date1
AND orderheaders.OrderDateTime <= @date2 
And orderheaders.@BranchID 
AND orderheaders.LineDeleted=0
UNION ALL
SELECT 'Net Satış Tutarı' AS Tipi, SUM(orderheaders.AmountDue) AS Tutar 
FROM orderheaders
WHERE orderheaders.orderdatetime >= @date1
AND orderheaders.orderdatetime <= @date2
AND orderheaders.@BranchID AND orderheaders.LineDeleted=0
UNION ALL
Select
'Kasa Ödemeleri' as Tipi, Sum(Expenses.ExpenseAmount) As Tutar
FROM expenses Where expenses.ExpenseDatetime <=@date2 And expenses.ExpenseDatetime >=@date1 
And expenses.@BranchID 
AND LineDeleted=0
UNION ALL
SELECT 'Brut Satış Tutarı' as Tipi,
(SUM(orderheaders.amountdue) + SUM(orderheaders.discountTotalAmount)) as Tutar
FROM OrderHeaders WHERE orderheaders.OrderDateTime>=@date1 
AND orderheaders.OrderDateTime<=@date2 
AND orderheaders.LineDeleted=0 
AND orderheaders.@BranchID