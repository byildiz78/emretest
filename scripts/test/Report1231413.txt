SELECT
	OrderPayments.OrderID AS [ÇEK NO],
	CONVERT ( CHAR ( 24 ), OrderPayments.PaymentDateTime, 120 ) AS [Ödeme Tarihi],
	CASE WHEN OrderType=1 THEN 'Masa Satış'
	WHEN OrderTypeSourceExternalNo LIKE '%Sepet%' THEN 'Yemek Sepeti'
 WHEN OrderTypeSourceExternalNo LIKE '%trendyol%' THEN 'Trendyol'
   WHEN OrderTypeSourceExternalNo LIKE '%QR%' THEN 'QR Menu'
WHEN OrderTypeSourceExternalNo LIKE '%web%' AND OrderSource=3 THEN 'Web Sipariş'
WHEN Ordertype=5  THEN 'Paket Servis'
ELSE 'Satış' END 
AS Tipi,


	CONVERT ( CHAR ( 24 ), OrderHeaders.AddDateTime, 120 ) AS [Açılış Tarihi],
         CONVERT ( CHAR ( 24 ), OrderHeaders.EditDateTime, 120 ) AS [Kapanış Tarihi],
	OrderHeaders.AmountDue AS [Sipariş Tutar],
	OrderPayments.AmountPaid AS [Ödenen TUTAR],
	ISNULL( OrderPayments.PaymentMethodName, 'TANIMSIZ' ) AS [ÖDEME TİPİ]
FROM
	OrderPayments
	INNER JOIN OrderHeaders ON OrderHeaders.OrderKey = OrderPayments.OrderKey 
WHERE
	OrderPayments.LineDeleted = 0 
	AND OrderHeaders.LineDeleted= 0 
	AND PaymentDateTime >= @date1 
	AND PaymentDateTime <= @date2 
	AND orderpayments.@BranchID