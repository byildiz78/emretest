SELECT 'Cari Hesap Tahsilat'as Tipi, sum(OnAccountPayments.AmountPaid) as Tutar
FROM  OnAccountPayments WHERE  
OnAccountPayments.PaymentDateTime <=@sonTarih And   OnAccountPayments.PaymentDateTime >=@ilkTarih And OnAccountPayments.@BranchID

UNION ALL 

SELECT     'Cari Hesap Satış'as Tipi, sum(OnAccountCharges.AmountCharged) as Tutar
FROM         OnAccountCharges
WHERE  OnAccountCharges.ChargeDateTime <=@sonTarih And   OnAccountCharges.ChargeDateTime >=@ilkTarih And OnAccountCharges.@BranchID

UNION ALL

Select 'Ek Fiyat Kullanımı' as Tipi,
 Sum(gsorderheaders.SurchargeAmount) As Tutar
From
  gsorderheaders WHERE gsorderheaders.OrderDateTime <=@sonTarih And  gsorderheaders.OrderDateTime >=@ilkTarih And gsorderheaders.@BranchID

UNION ALL
Select 'Çek İndirimleri' as Tipi,
  Sum(gsorderheaders.DiscountAmountUsed) As Tutar
From
  gsorderheaders WHERE gsorderheaders.OrderDateTime <=@sonTarih And  gsorderheaders.OrderDateTime >=@ilkTarih And gsorderheaders.@BranchID
 AND gsorderheaders.OrderStatus<>'3' 
 
UNION ALL

Select 'Nakit İndirimler' as Tipi,
  Sum(gsorderheaders.CashDiscountAmount) As Tutar
From
  gsorderheaders WHERE gsorderheaders.OrderDateTime <=@sonTarih And  gsorderheaders.OrderDateTime >=@ilkTarih And gsorderheaders.@BranchID
   AND gsorderheaders.OrderStatus<>'3' 
UNION ALL

SELECT 'Ürün İndirimleri' as Tipi,
 SUM(gsOrderTransactions.DiscountAmountUsed)
From
  gsOrderTransactions where gsOrderTransactions.OrderDateTime >= @ilkTarih
 AND gsOrderTransactions.OrderDateTime <= @sonTarih
 AND gsOrderTransactions.@BranchID AND gsOrderTransactions.transactionstatus='1'

UNION ALL
SELECT 'İptal Tutarı' AS Tipi,
       ROUND(SUM(OrderVoidLogs.VoidAmount), 2) AS Tutar
FROM   OrderVoidLogs
WHERE  OrderVoidLogs.VoidDateTime >= @ilkTarih
       AND OrderVoidLogs.VoidDateTime <= @sonTarih And OrderVoidLogs.@BranchID

UNION ALL
SELECT 'Toplam Kasa' AS Tipi,
       Round (SUM(gsOrderPayments.AmountPaid)-((Select  Sum(PayOuts.PayOutAmount) As Tutar
FROM PayOuts Where PayOuts.PayOutDateTime <=@sonTarih And PayOuts.PayOutDateTime >=@ilkTarih And PayOuts.@BranchID)),2) AS Tutar
FROM   gsOrderPayments
WHERE  gsOrderPayments.PaymentDateTime >= @ilkTarih
       AND gsOrderPayments.PaymentDateTime <= @sonTarih  And gsOrderPayments.@BranchID

UNION ALL
SELECT 'Açık Çekler' AS Tipi,
       SUM(gsorderheaders.AmountDue) AS Toplam
FROM   gsorderheaders
WHERE  gsorderheaders.OrderStatus = '1'
       AND gsorderheaders.OrderDateTime >= @ilkTarih
       AND gsorderheaders.OrderDateTime <= @sonTarih  And gsorderheaders.@BranchID

UNION ALL
SELECT     'Satış Tutarı' AS Tipi, SUM(gsorderheaders.AmountDue) AS Tutar 
FROM         gsorderheaders INNER JOIN
                      efr_Branchs ON gsorderheaders.BranchID = efr_Branchs.BranchID
 WHERE  gsorderheaders.orderdatetime >= @ilkTarih
                  AND gsorderheaders.orderdatetime <= @sonTarih
                  AND gsorderheaders.@BranchID AND gsorderheaders.OrderStatus<>'3'

UNION ALL
Select
  'Kasa Ödemeleri' as Tipi,
  Sum(PayOuts.PayOutAmount) As Tutar
FROM PayOuts Where PayOuts.PayOutDateTime <=@sonTarih And PayOuts.PayOutDateTime >=@ilkTarih And PayOuts.@BranchID

