Detail|
select Tipi,ROUND(SUM(Tutar),2) as Tutar,SUM(ÇekSayısı) ÇekSayısı,SUM(KisiSayisi) KisiSayisi from (
SELECT 
CASE 
WHEN h.OrderType=1 THEN 'Masa Satış'
WHEN h.OrderType=2 THEN 'İsme Çek'
WHEN h.OrderType=3 THEN 'Kasa Satış'
WHEN h.Ordertype=4 THEN 'Tezgah Satış'
WHEN h.Ordertype=5 and h.OrderTypeSourceExternalNo LIKE '%sepet%' THEN 'Yemek Sepeti'
WHEN h.Ordertype=5 and h.OrderTypeSourceExternalNo LIKE '%web%' THEN 'Web Sipariş'
WHEN h.Ordertype=5 and h.OrderTypeSourceExternalNo LIKE '%Getir%' THEN 'Getir'
WHEN h.Ordertype=5 and h.OrderTypeSourceExternalNo LIKE '%trendyol%' THEN 'Trendyol'
WHEN (h.Ordertype=5 and h.OrderTypeSourceExternalNo NOT LIKE '%web%' and h.OrderTypeSourceExternalNo NOT LIKE '%sepet%' and h.OrderTypeSourceExternalNo NOT LIKE '%trendyol%'  and h.OrderTypeSourceExternalNo NOT LIKE '%Getir%') or h.OrderTypeSourceExternalNo IS NULL THEN 'Paket Servis'
END Tipi
,Round(SUM(h.AmountDue),2) AS Tutar
,Count(h.OrderID) as ÇekSayısı
,Sum(h.GuestNumber) as KisiSayisi 
FROM OrderHeaders h
WHERE 1=1 
and h.OrderDateTime BETWEEN @date1 and @date2
and h.@BranchID 
AND h.lineDeleted=0 
GROUP BY h.OrderType,h.OrderTypeSourceExternalNo) AS TABLO GROUP BY Tipi