SELECT
*
FROM 
(
SELECT  t.OrderTransactionID,t.OrderID AS CekNo, h.OrderDateTime AS Tarihi,
 m.MenuItemText AS Urun, t.MenuItemUnitPrice AS BirimFiyati, t.Quantity AS Miktar,
 t.ExtendedPrice AS SatirBedeli, ((t.MenuItemUnitPrice * t.Quantity) -t.ExtendedPrice) AS SatirIndirim,
 h.AmountDue AS TahsilEdilen,(isnull(h.DiscountAmountUsed,0)+isnull(h.CashDiscountAmount,0))  AS AltIskonto, (t.ExtendedPrice / 118 * 18) AS KDV, 0 AS KDV8
FROM OrderTransactions AS t INNER JOIN OrderHeaders AS h ON t.OrderID = h.OrderID  INNER JOIN MenuItems AS m
 ON t.MenuItemID = m.MenuItemID WHERE m.MenuCategoryID = 1 AND t.TransactionStatus='1' AND h.AmountDue>0

 UNION ALL
 SELECT  t.OrderTransactionID,t.OrderID AS CekNo, h.OrderDateTime AS Tarihi,
 m.MenuItemText AS Urun, t.MenuItemUnitPrice AS BirimFiyati, t.Quantity AS Miktar,
 t.ExtendedPrice AS SatirBedeli, ((t.MenuItemUnitPrice * t.Quantity) -t.ExtendedPrice) AS SatirIndirim,
 h.AmountDue AS TahsilEdilen, (isnull(h.DiscountAmountUsed,0)+isnull(h.CashDiscountAmount,0)) AS AltIskonto, 0 AS KDV, (t.ExtendedPrice / 108 * 8) AS KDV8
FROM OrderTransactions AS t INNER JOIN OrderHeaders AS h ON t.OrderID = h.OrderID  INNER JOIN MenuItems AS m
 ON t.MenuItemID = m.MenuItemID WHERE m.MenuCategoryID <> 1 AND t.TransactionStatus='1' AND h.AmountDue>0 


) AS result WHERE   
 OrderTransactions.OrderDateTime <= @sonTarih 
       AND OrderTransactions.OrderDateTime >= @ilkTarih  
       AND  
       OrderTransactions.@BranchID

ORDER BY result.CekNo
