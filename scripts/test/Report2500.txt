DECLARE @startDate DATETIME;set @startDate=GETDATE();
IF DATEPART(hour,@startDate)<6
 set @startDate=DATEADD(dd, -1, DATEDIFF(dd, 0, @startDate))
ELSE
set @startDate=DATEADD(dd, 0, DATEDIFF(dd, 0, @startDate))
SELECT SUM(gsOrderheaders.AmountDue) AS Tutar, efr_Branchs.BranchName AS [Şube Adı]
FROM gsOrderheaders INNER JOIN
 efr_Branchs ON gsOrderheaders.BranchID = efr_Branchs.BranchID
 WHERE gsOrderheaders.orderdatetime >= @startDate
 AND gsOrderheaders.@BranchID and gsOrderheaders.OrderStatus<>'3'
GROUP BY efr_Branchs.BranchName