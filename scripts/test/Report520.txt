declare @AdisyonSayisi int

set @AdisyonSayisi =(
select count(1) from OrderHeaders WITH (NOLOCK)
where OrderType=5
and LineDeleted=0
and OrderDateTime between @date1 and @date2
and @BranchID
);

select 
@AdisyonSayisi as AdisyonSayisi ,
round(SUM(isnull(h.AmountDue,0))/(case when @AdisyonSayisi=0 then 1 else @AdisyonSayisi end),2) as paketciro
from OrderHeaders h WITH (NOLOCK)
where h.OrderType=5
and h.LineDeleted=0
and h.@BranchID
and h.OrderDateTime between @date1 and @date2
