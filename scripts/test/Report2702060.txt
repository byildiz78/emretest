DECLARE @dt1 DATETIME,@dt2 DATETIME
SELECT @dt1=@date1,@dt2=@date2

SELECT 
b.BranchName,
CASE WHEN oh.OrderType=1 THEN 'Masa Satış'
WHEN oh.OrderType=3 THEN 'Kasa Satış'
WHEN oh.Ordertype=4 THEN 'Tezgah Satış'
WHEN oh.Ordertype=5 and oh.OrderTypeSourceExternalNo LIKE '%YemekSepeti_%' THEN 'Yemek Sepeti'
WHEN oh.Ordertype=5 and oh.OrderTypeSourceExternalNo LIKE '%WebOrder_%' THEN 'Web Sipariş'
WHEN oh.Ordertype=5 THEN 'Paket Servis'
ELSE 'İsme Çek' END 
AS Tipi,
oh.OrderID as [Çek No],
ot.MenuItemText as [Ürün Adı],
sum(ot.quantity) as [Satış miktarı],
sum(ot.ExtendedPrice) as [Toplam satış tutarı]
FROM OrderTransactions as ot
INNER JOIN OrderHeaders as oh on oh.OrderKey=ot.OrderKey
INNER JOIN efr_Branchs b on b.BranchID=ot.BranchID
WHERE ot.OrderDateTime between @dt1 and @dt2
and oh.@BranchID 
AND ot.lineDeleted=0 
AND oh.LineDeleted=0
GROUP BY b.BranchName,oh.orderID,ot.MenuItemText,oh.OrderType,oh.OrderTypeSourceExternalNo
Order By oh.OrderType asc