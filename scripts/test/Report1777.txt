SELECT 
SUM(OrderPayments.AmountPaid) AS GenelTOPLAM,
(OrderPayments.PaymentMethodName + (CASE WHEN ISNULL(OrderPayments.GlobalBankName,'') = '' THEN '' ELSE (' - ' + OrderPayments.GlobalBankName) END) + (CASE WHEN OrderHeaders.IsInvoice = 1 THEN ' (FATURA)' ELSE '' END)) AS [ÖDEME TİPİ],
efr_Branchs.BranchName AS SUBE,
CONVERT(VARCHAR, OrderPayments.PaymentDateTime, 103) AS GUN       
FROM   OrderPayments WITH (NOLOCK)
INNER JOIN OrderHeaders WITH (NOLOCK) ON OrderHeaders.OrderKey=OrderPayments.OrderKey
LEFT OUTER JOIN efr_Branchs
ON  OrderPayments.BranchID = efr_Branchs.BranchID
WHERE  orderpayments.PaymentDateTime >= @date1
AND orderpayments.PaymentDateTime <= @date2
AND OrderPayments.LineDeleted = 0
AND orderpayments.@BranchID
GROUP BY
(OrderPayments.PaymentMethodName + (CASE WHEN ISNULL(OrderPayments.GlobalBankName,'') = '' THEN '' ELSE (' - ' + OrderPayments.GlobalBankName) END) + (CASE WHEN OrderHeaders.IsInvoice = 1 THEN ' (FATURA)' ELSE '' END)),
efr_Branchs.BranchName,  
CONVERT(VARCHAR, OrderPayments.PaymentDateTime, 103)