Detail|SELECT SUM(r.tutar) AS Tutar,
       SUM(r.Konuk) AS Konuk,
       COUNT(r.Cek) AS Cek,
       r.saat
FROM  
 (
           SELECT h.GuestNumber AS Konuk,
                  CONVERT(VARCHAR, h.OrderDateTime, 100) AS saat,
                  h.amountdue AS tutar,
                  h.OrderKey AS Cek
           FROM   OrderHeaders h
           WHERE  H.OrderDateTime >= @date1
                  AND H.OrderDateTime <= @date2 AND 
                  h.linedeleted = 0 and h.@BranchID
       ) AS r
GROUP BY
       r.saat
       
       ORDER BY   R.SAAT ASC

$INDIRIMLER|

SELECT SUM(r.[Brüt Satışlar]) AS [Brüt Satışlar],
       SUM(r.[Ürün İndirimleri]) AS [Ürün İndirimleri],
       SUM(r.[Nakit İndirimler]) AS [Nakit İndirimler],
       SUM(r.[Çek İndirimler]) AS [Çek İndirimler],
       SUM(r.[Toplam Indirimler]) AS [Toplam Indirimler],
       SUM(r.[Net Satışlar]) AS [Net Satışlar],
       COUNT(r.[Toplam Çek Sayısı]) AS [Toplam Çek Sayısı],
       SUM(r.[Toplam Konuk]) AS [Toplam Konuk],
       SUM(r.[Net Satışlar]) / NULLIF(SUM(r.[Toplam Konuk]), 0) AS 
       [Kişi Başı Ortalama],
       SUM(r.[Net Satışlar]) / NULLIF(COUNT(r.[Toplam Çek Sayısı]), 0) AS 
       [Çek Ortalama],
       r.GUN
FROM   (
           SELECT h.amountdue + h.discountTotalAmount AS [Brüt Satışlar],
                  h.DiscountLineAmount AS [Ürün İndirimleri],
                  h.DiscountCashAmount AS [Nakit İndirimler],
                  h.DiscountOrderAmount AS [Çek İndirimler],
                  h.DiscountTotalAmount AS [Toplam Indirimler],
                  h.amountdue AS [Net Satışlar],
                  h.OrderID AS [Toplam Çek Sayısı],
                  h.GuestNumber AS [Toplam Konuk],
                  h.amountdue / ISNULL(h.GuestNumber, 1) AS [Kişi Başı Ortalama],
                  h.amountdue / ISNULL(h.orderID, 1) AS [Çek Ortalama],
                  DATEPART(Hour, h.orderdatetime) AS GUN,
                  h.amountdue AS [GÜNLÜK TUTAR]
           FROM   OrderHeaders h
           WHERE  h.LineDeleted = 0
                  AND h.OrderDateTime >= @date1
                  AND h.OrderDateTime <= @date2 and h.@BranchID
       ) AS r
GROUP BY
       r.GUN