Detail|
SELECT t.MenuItemText as [Ürün],
 SUM(t.Quantity) AS Adet, 
 CONVERT(dec(10,2),SUM(t.ExtendedPrice))AS Tutar,
 SUM(h.AmountDue) AS [TOPLAM URUNSATIS TL],
 sum(t.ExtendedPrice)/ SUM(nullif(h.AmountDue,0)) AS URUNYUZDE,
 t.MenuItemGroupText as Grup,
 t.MenumItemCategoryText as Kategori,
 t.AddUserName as Personel,
 CASE h.OrderType
 WHEN '1' THEN 'MASA SERVIS'
 WHEN '2' THEN 'İSME ÇEK'
 WHEN '3' THEN 'AL GÖTÜR'
 WHEN '4' THEN 'TEZGAH'
 WHEN '5' THEN 'PAKET SERVIS'
 ELSE 'TANIMSIZ'
 END AS 'Satış Türü'
FROM OrderTransactions AS t
LEFT OUTER JOIN OrderHeaders AS h ON t.OrderKey = h.OrderKey AND h.LineDeleted=0 AND h.BranchID=t.BranchID
WHERE t.LineDeleted = 0
AND t.OrderDateTime >= @date1
AND t.OrderDateTime <= @date2 and t.@BranchID 
GROUP BY MenuItemText, h.OrderType, t.ExtendedPrice, t.Quantity, t.MenuItemGroupText, t.MenumItemCategoryText, h.AmountDue, t.AddUserName
ORDER BY t.MenuItemText ASC
$INDIRIMLER| SELECT (SUM(h.amountdue) + SUM(h.discountTotalAmount)) AS [Brüt Satışlar],
 SUM(h.DiscountLineAmount) AS [Ürün İndirimleri],
 SUM(h.DiscountCashAmount) AS [Nakit İndirimler],
 SUM(h.DiscountOrderAmount) AS [Çek İndirimler],
 SUM(h.DiscountTotalAmount) AS [Toplam Indirimler],
 SUM(h.amountdue) AS [Net Satışlar],
 COUNT(h.OrderKey) AS [Toplam Çek Sayısı],
 SUM(h.GuestNumber) AS [Toplam Konuk],
 SUM(h.amountdue) / ISNULL(SUM(h.GuestNumber), 1) AS [Kişi Başı Ortalama],
 SUM(h.amountdue) / ISNULL(COUNT(h.orderkey), 1) AS [Çek Ortalama]
FROM OrderHeaders  as h
WHERE h.LineDeleted = 0
 AND h.OrderDateTime >= @ilkTarih
 AND h.OrderDateTime <= @SonTarih
and h.@BranchID