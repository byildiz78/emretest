select 
b.BranchName as [Şube],
t.MenuItemtext as [Ürün],
CAST(DATEPART(MONTH,h.OrderDateTime) AS VARCHAR) as Ay,
ROUND(SUM(t.ExtendedPrice * isnull(nullif(h.AmountDue,0),1) / isnull(nullif(h.SubTotal,0),1) ), 2) as Tutar,
SUM(t.Quantity) as Adet
from OrderTransactions t with(nolock)
INNER JOIN OrderHeaders h with(nolock) on h.OrderKey=t.OrderKey
INNER JOIN efr_Branchs b on b.BranchID=h.BranchID
where 1=1
AND h.OrderDateTime BETWEEN @date1 and @date2
AND h.@BranchID
GROUP BY b.BranchName,t.MenuItemtext,CAST(DATEPART(MONTH,h.OrderDateTime) AS VARCHAR)