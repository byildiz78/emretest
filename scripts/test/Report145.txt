DECLARE @startDate DATETIME;set @startDate=GETDATE();
IF DATEPART(hour,@startDate)<6
 set @startDate=DATEADD(dd, -1, DATEDIFF(dd, 0, @startDate))
ELSE
set @startDate=DATEADD(dd, 0, DATEDIFF(dd, 0, @startDate))

SELECT 'Cari Hesap Tahsilat'as Tipi, sum(OnAccountPayments.AmountPaid) as Tutar
FROM OnAccountPayments WHERE 
OnAccountPayments.PaymentDateTime >=@startDate And OnAccountPayments.@BranchID

UNION ALL
SELECT 'Cari Hesap Satış'as Tipi, sum(OnAccountCharges.AmountCharged) as Tutar
FROM OnAccountCharges
WHERE OnAccountCharges.ChargeDateTime >=@startDate And OnAccountCharges.@BranchID

UNION ALL
Select 'Ek Fiyat Kullanımı' as Tipi,
 Sum(OrderHeaders.SurchargeAmount) As Tutar
From
 OrderHeaders WHERE OrderHeaders.OrderDateTime >=@startDate And OrderHeaders.@BranchID

UNION ALL
Select 'Çek İndirimleri' as Tipi,
 Sum(OrderHeaders.DiscountAmountUsed) As Tutar
From
 OrderHeaders WHERE OrderHeaders.OrderDateTime >=@startDate And OrderHeaders.@BranchID
 AND orderheaders.OrderStatus<>'3' 
 
UNION ALL
Select 'Nakit İndirimler' as Tipi,
 Sum(OrderHeaders.CashDiscountAmount) As Tutar
From
 OrderHeaders WHERE OrderHeaders.OrderDateTime >=@startDate And OrderHeaders.@BranchID
 AND orderheaders.OrderStatus<>'3' 
UNION ALL

SELECT 'Ürün İndirimleri' as Tipi,
 SUM(OrderTransactions.DiscountAmountUsed)
From
 OrderTransactions where OrderTransactions.OrderDateTime >= @startDate
 AND OrderTransactions.@BranchID AND OrderTransactions.transactionstatus='1'

UNION ALL
SELECT 'İptal Tutarı' AS Tipi,
 ROUND(SUM(OrderVoidLogs.VoidAmount), 2) AS Tutar
FROM OrderVoidLogs
WHERE OrderVoidLogs.VoidDateTime >= @startDate And OrderVoidLogs.@BranchID

UNION ALL
SELECT 'Toplam Kasa' AS Tipi,
 Round (SUM(OrderPayments.AmountPaid)-((Select Sum(PayOuts.PayOutAmount) As Tutar
FROM PayOuts Where PayOuts.PayOutDateTime >=@startDate And PayOuts.@BranchID)),2) AS Tutar
FROM OrderPayments
WHERE OrderPayments.PaymentDateTime >= @startDate And OrderPayments.@BranchID

UNION ALL
SELECT 'Açık Çekler' AS Tipi,
 SUM(OrderHeaders.AmountDue) AS Toplam
FROM OrderHeaders
WHERE OrderHeaders.OrderStatus = '1'
 AND OrderHeaders.OrderDateTime >= @startDate
 And OrderHeaders.@BranchID

UNION ALL
SELECT 'Satış Tutarı' AS Tipi, SUM(Orderheaders.AmountDue) AS Tutar 
FROM Orderheaders INNER JOIN
 efr_Branchs ON orderheaders.BranchID = efr_Branchs.BranchID
 WHERE orderheaders.orderdatetime >= @startDate
 AND orderheaders.@BranchID AND orderheaders.OrderStatus<>'3'

UNION ALL
Select
 'Kasa Ödemeleri' as Tipi,
 Sum(PayOuts.PayOutAmount) As Tutar
FROM PayOuts Where PayOuts.PayOutDateTime >=@startDate And PayOuts.@BranchID