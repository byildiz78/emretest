SELECT
	H.OrderKey,
	H.OrderID,
	H.BranchID,
	H.OrderDateTime,
	BR.BranchName
FROM
	OrderHeaders H
LEFT JOIN OrderPayments T ON T.OrderKey = H.OrderKey
LEFT JOIN efr_Branchs BR ON BR.BranchID = H.BranchID
WHERE
	1 = 1
	AND H.BranchID IN (1,2,3,4,25,26,36,49,65,74,76,95,98,107,116,22,125)
	AND H.OrderDateTime BETWEEN @date1 AND @date2
	AND H.LineDeleted = 0
	AND H.OrderStatus = 2
	AND H.AmountDue > 0
GROUP BY 
	H.OrderKey, H.OrderID, H.BranchID, H.OrderDateTime, BR.BranchName 
HAVING 
	COUNT(T.AutoID) = 0;