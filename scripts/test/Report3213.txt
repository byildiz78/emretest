select 

b.BranchName as Şube,

case h.OrderTypeSourceID when 101 then 'Yemek Sepeti'

when 103 then 'Web Sipariş'

when 104 then 'Getir'

when 107 then 'Trenyol Yemek'

else 'Diğer' end as [Online Kanal],

p.PaymentMethodName as [Ödeme Tipi],

cast(p.AmountPaid as decimal(18,2)) as [Ödenen Tutar]

from OrderHeaders h with(nolock)

inner join OrderPayments p with(nolock) on p.OrderKey=h.OrderKey

inner join efr_Branchs b on b.BranchID=h.BranchID

where 

h.OrderDateTime between @date1 and @date2

and h.LineDeleted=0

and p.LineDeleted=0

and OrderTypeSourceID in(101,103,104,107)

and h.@BranchID



order by b.BranchName