Select r.[Şube adı],r.Ürün,r.Grup,r.Miktar,r.Tutar,r.Gramaj,r.[Toplam Gramaj] from (

Select 
eb.BranchName as [Şube adı],
ot.MenuItemText as [Ürün],
ot.MenuItemGroupText as [Grup],
Sum(ot.Quantity) as [Miktar],
Sum(ot.ExtendedPrice) as [Tutar],
ISNULL(p.Barcode2,1) as [Gramaj],
p.Barcode2 * sum(ot.Quantity) as [Toplam Gramaj]

from OrderTransactions as ot 
INNER JOIN posProducts as p on p.ProductKey=ot.MenuItemKey
INNER JOIN efr_Branchs as  eb on eb.BranchID = ot.BranchID

where ot.LineDeleted=0
AND ot.TransactionDateTime >= @date1 AND ot.TransactionDateTime <= @date2
AND ot.@BranchID
--AND ISNULL(p.Barcode2, 1) >= 1  
--AND ot.ExtendedPrice >= 0
Group by eb.BranchName,ot.MenuItemText,ot.MenuItemGroupText,p.Barcode2) as r
